2025-04-29 05:00:34,031 - __main__ - INFO - Created or verified directories: /tmp/results_20250429_050033
2025-04-29 05:00:34,031 - __main__ - INFO - Loading data...
2025-04-29 05:00:34,031 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/stock_data.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,031 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor1.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,031 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor10.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,031 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor100.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,031 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor101.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,031 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor102.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,032 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor103.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,032 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor104.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,032 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor105.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,032 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor106.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,032 - __main__ - INFO - Warning: Skip reading /workspace/quant_code_dataset/RawData/NFactors/factor107.parquet: Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
2025-04-29 05:00:34,032 - __main__ - INFO - Loaded 0 factor files
2025-04-29 05:00:34,032 - __main__ - ERROR - Error loading return data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-04-29 05:00:34,032 - __main__ - ERROR - Failed to load data. Exiting.
2025-04-29 05:01:09,996 - __main__ - INFO - Created or verified directories: /tmp/results_20250429_050109
2025-04-29 05:01:09,996 - __main__ - INFO - Loading data...
2025-04-29 05:01:12,863 - __main__ - INFO - Loaded 11 factor files
2025-04-29 05:01:14,248 - __main__ - INFO - Successfully loaded all data files
2025-04-29 05:01:14,248 - __main__ - INFO - Filtering factors...
2025-04-29 05:01:14,595 - __main__ - INFO - Filtered factors from 11 to 10
2025-04-29 05:01:14,595 - __main__ - INFO - Processing factors...
2025-04-29 05:01:14,595 - __main__ - INFO - Processing 10 factors using 40 workers
2025-04-29 05:01:23,518 - __main__ - INFO - Processed 10 factors in 8.92 seconds
2025-04-29 05:01:23,632 - __main__ - INFO - Finding common indices...
2025-04-29 05:01:26,125 - __main__ - INFO - Running prediction...
2025-04-29 05:01:26,125 - __main__ - INFO - Running simulation 1/3
2025-04-29 05:03:08,842 - __main__ - INFO - Running simulation 2/3
2025-04-29 05:04:41,342 - __main__ - INFO - Running simulation 3/3
2025-04-29 05:06:16,625 - __main__ - INFO - Applying filters...
2025-04-29 05:06:16,842 - __main__ - INFO - Applied filters: 1676 rows remaining
2025-04-29 05:06:16,842 - __main__ - INFO - Calculating metrics...
2025-04-29 05:06:30,669 - __main__ - INFO - Saving results...
2025-04-29 05:06:31,566 - __main__ - INFO - Results saved to /tmp/results_20250429_050109/predictions_20250429_050630.parquet and /tmp/results_20250429_050109/metrics_20250429_050630.json
2025-04-29 05:06:31,566 - __main__ - INFO - Total processing time: 321.57 seconds
2025-04-29 05:06:31,566 - __main__ - INFO - 
==================================================
PERFORMANCE METRICS
==================================================
2025-04-29 05:06:31,566 - __main__ - INFO - Overall Rank Correlation: 0.0667
2025-04-29 05:06:31,566 - __main__ - INFO - 2020 Rank Correlation: 0.0694
2025-04-29 05:06:31,566 - __main__ - INFO - 2021 Rank Correlation: 0.0578
2025-04-29 05:06:31,566 - __main__ - INFO - 2022 Rank Correlation: 0.0705
2025-04-29 05:06:31,566 - __main__ - INFO - 2023 Rank Correlation: 0.0694
2025-04-29 05:06:31,567 - __main__ - INFO - ==================================================
Full report saved to: /tmp/results_20250429_050109/metrics_20250429_050630.json
==================================================
2025-04-29 05:17:44,204 - __main__ - INFO - Created or verified directories: /tmp/results_20250429_051743
2025-04-29 05:17:44,204 - __main__ - INFO - Loading data...
2025-04-29 05:17:47,055 - __main__ - INFO - Loaded 11 factor files
2025-04-29 05:17:48,471 - __main__ - INFO - Successfully loaded all data files
2025-04-29 05:17:48,471 - __main__ - INFO - Filtering factors...
2025-04-29 05:17:48,824 - __main__ - INFO - Filtered factors from 11 to 10
2025-04-29 05:17:48,824 - __main__ - INFO - Processing factors...
2025-04-29 05:17:48,824 - __main__ - INFO - Processing 10 factors using 40 workers
2025-04-29 05:17:57,364 - __main__ - INFO - Processed 10 factors in 8.54 seconds
2025-04-29 05:17:57,475 - __main__ - INFO - Finding common indices...
2025-04-29 05:17:59,820 - __main__ - INFO - Running prediction...
2025-04-29 05:17:59,820 - __main__ - INFO - Running simulation 1/3
2025-04-29 05:18:46,130 - __main__ - INFO - Created or verified directories: /tmp/results_20250429_051845
2025-04-29 05:18:46,130 - __main__ - INFO - Loading data...
2025-04-29 05:18:48,970 - __main__ - INFO - Loaded 11 factor files
2025-04-29 05:18:50,338 - __main__ - INFO - Successfully loaded all data files
2025-04-29 05:18:50,339 - __main__ - INFO - Filtering factors...
2025-04-29 05:18:50,691 - __main__ - INFO - Filtered factors from 11 to 10
2025-04-29 05:18:50,691 - __main__ - INFO - Processing factors...
2025-04-29 05:18:50,691 - __main__ - INFO - Processing 10 factors using 40 workers
2025-04-29 05:18:59,737 - __main__ - INFO - Processed 10 factors in 9.05 seconds
2025-04-29 05:18:59,864 - __main__ - INFO - Finding common indices...
2025-04-29 05:19:02,425 - __main__ - INFO - Running prediction...
2025-04-29 05:19:02,426 - __main__ - INFO - Running simulation 1/3
2025-04-29 05:20:18,066 - __main__ - INFO - Running simulation 2/3
2025-04-29 05:21:45,532 - __main__ - INFO - Running simulation 3/3
2025-04-29 05:23:00,433 - __main__ - INFO - Applying filters...
2025-04-29 05:23:00,642 - __main__ - INFO - Applied filters: 1676 rows remaining
2025-04-29 05:23:00,642 - __main__ - INFO - Calculating metrics...
2025-04-29 05:23:13,901 - __main__ - INFO - Saving results...
2025-04-29 05:23:14,765 - __main__ - INFO - Results saved to /tmp/results_20250429_051845/predictions_20250429_052313.parquet and /tmp/results_20250429_051845/metrics_20250429_052313.json
2025-04-29 05:23:14,765 - __main__ - INFO - Total processing time: 268.64 seconds
2025-04-29 05:23:14,765 - __main__ - INFO - 
==================================================
PERFORMANCE METRICS
==================================================
2025-04-29 05:23:14,765 - __main__ - INFO - Overall Rank Correlation: 0.0666
2025-04-29 05:23:14,766 - __main__ - INFO - Overfitting Gap: 0.0803
2025-04-29 05:23:14,766 - __main__ - INFO - Model Robustness (std of yearly correlations): 0.0053
2025-04-29 05:23:14,766 - __main__ - INFO - 2020 Rank Correlation: 0.0695
2025-04-29 05:23:14,766 - __main__ - INFO - 2021 Rank Correlation: 0.0576
2025-04-29 05:23:14,766 - __main__ - INFO - 2022 Rank Correlation: 0.0709
2025-04-29 05:23:14,766 - __main__ - INFO - 2023 Rank Correlation: 0.0687
2025-04-29 05:23:14,766 - __main__ - INFO - ==================================================
Full report saved to: /tmp/results_20250429_051845/metrics_20250429_052313.json
==================================================
